name: CI ‚Äî Infrastructure Checks

on:
  push:
    branches: [ main ]
  pull_request:
    branches: [ main ]

jobs:
  validate:
    name: –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –∏ —Ñ–∞–π–ª–æ–≤
    runs-on: ubuntu-latest

    steps:
    - name: üì• Checkout —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è
      uses: actions/checkout@v3

    - name: üß™ –ü—Ä–æ–≤–µ—Ä–∫–∞ Markdown
      uses: DavidAnson/markdownlint-cli2-action@v13
      with:
        globs: |
          **/*.md

    - name: üß™ –ü—Ä–æ–≤–µ—Ä–∫–∞ YAML
      uses: ibiqlik/action-yamllint@v3
      with:
        config_file: .yamllint.yaml

    - name: üß™ –ü—Ä–æ–≤–µ—Ä–∫–∞ DNS-–∑–æ–Ω (named-checkzone)
      run: |
        sudo apt update && sudo apt install -y bind9-utils
        for zone in network/zones/*.example; do
          echo "–ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–æ–Ω—ã: $zone"
          named-checkzone reu-syslab.dev $zone
        done
